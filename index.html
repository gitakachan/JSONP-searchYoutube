<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSONP</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Search YouTube Videos</h1>

    <div class="yt">
      <input type="text" id="search" />
      <ul id="resultList">
        <!-- <li><a href=""></a></li> -->
        <!-- <li><a href=""></a></li> -->
        <!-- <li><a href=""></a></li> -->
      </ul>
    </div>

    <script>
      let resultList = document.querySelector("#resultList");

      //自訂callback (記得要和url裡的callback一樣名稱)
      function cb(data) {
        resultList.style.display = "block";
        resultList.innerHTML = ""; //每次都先清空
        let length = data[1].length;
        for (let i = 0; i < length; i++) {
          let li = document.createElement("li");
          let a = document.createElement("a");
          a.innerHTML = data[1][i][0];
          //範例：https://www.youtube.com/results?search_query=run
          a.href = `https://www.youtube.com/results?search_query=${data[1][i][0]}`;
          a.target = "_blank";
          li.appendChild(a);
          resultList.appendChild(li);
        }
      }
    </script>
    <script>
      window.onload = function () {
        let search = document.querySelector("#search");
        let resultList = document.querySelector("#resultList");

        search.onkeyup = function () {
          //console.log(this.value);
          let value = this.value; //檢索內容
          if (value == false) {
            //若沒有輸入
            resultList.style.display = "none";
          } else {
            //jsonp加載數據
            //範例：https://suggestqueries-clients6.youtube.com/complete/search?client=youtube&hl=zh-tw&gl=tw&gs_rn=64&gs_ri=youtube&tok=jRcEYCzYZo-W_Otr954tDg&ds=yt&cp=3&gs_id=1c5&q=run&callback=google.sbox.p50&gs_gbg=tVj4TOa7R18z2wTncx8dKkKUNXB0GS43
            let script = document.createElement("script");
            script.src = `https://suggestqueries-clients6.youtube.com/complete/search?client=youtube&hl=zh-tw&gl=tw&gs_rn=64&gs_ri=youtube&tok=jRcEYCzYZo-W_Otr954tDg&ds=yt&cp=3&gs_id=1c5&q=${value}&callback=cb`; //q內容隨檢索值改變、把callback名稱改成cb
            document.body.appendChild(script);
          }
        };
      };
    </script>
  </body>
</html>
